<html>

<head>
<script
	src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
</head>

<body ng-app="mainApp">

<!--   		<div ng-controller = "myCtrl"> -->
<!--          <input type = "file" file-model = "myFile"/> -->
<!--          <button ng-click = "uploadFile()">upload me</button> -->
<!--       </div> -->

	<form ng-submit="uploadFile()" class="form-horizontal"
		enctype="multipart/form-data">
		<div ng-controller = "FileUploadController">
		<input type="file" name="file" ng-model="document.fileInput" id="file"
			onchange="angular.element(this).scope().setTitle(this)" /> <input
			type="text" class="col-sm-4" ng-model="document.title" id="title" />
<!-- 		<button class="btn btn-primary" type="submit">Submit</button> -->
<button ng-click = "uploadFile()">upload me</button>
</div>
	</form>

	<script>
	var mainApp=angular.module('mainApp', ['ngCookies']);

	mainApp.controller('FileUploadController', function($scope, $http) {

	    $scope.document = {};

	        $scope.setTitle = function(fileInput) {
			alert('debut');
	        var file=fileInput.value;
	        var filename = file.replace(/^.*[\\\/]/, '');
	        var title = filename.substr(0, filename.lastIndexOf('.'));
	        $("#title").val(title);
	        $("#title").focus();
	        $scope.document.title=title;
	    };
// 	    http://localhost:8080/springangularJs/users
	        $scope.uploadFile=function(){
				alert('debut service');
	             var formData=new FormData();
	         formData.append("file",file.files[0]);
	                   $http({
	                  method: 'POST',
	                  url: '/springangularJs/newDocument',
	                  headers: { 'Content-Type': 'multipart/form-data'},
	                  data:  formData
	                })
	                .success(function(data, status) {                       
	                    alert("Success ... " + status);
	                })
	                .error(function(data, status) {
	                    alert("Error ... " + status);
	                });
	      };
	});
	</script>

</body>
</html>